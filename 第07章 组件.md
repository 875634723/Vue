# # 简介

- 组件（Component）是 Vue.js 最强大的功能之一。
- 组件可以扩展 HTML 元素，封装可重用的代码。
- 组件系统让我们可以用独立可复用的小组件来构建大型应用。

注册一个全局组件的语法形式为：

```javascript
Vue.component(tagName, options)
```

tagName 为组件名，options 为配置选项。注册后，我们可以使用以下方式来调用组件：

```html
<tagName></tagName>
```

# # 使用组件

## 1、全局组件

```html
<div id="app">
    <my-component></my-component>
</div>
```

```javascript
// 注册组件
Vue.component('my-component', {
    template: '<p>A custom component!</p>'
})
// 创建根实例
var app = new Vue({
    el: '#app',
})
```

渲染为：

```html
<div id="app">
    <p>A custom component!</p>
</div>
```

> 提示：全局组件可应用于所有 vue 实例。

## 2、局部组件

```html
<div id="app">
    <my-component></my-component>
</div>
```

```javascript
var child = {
    template: '<p>A custom component!</p>'
}

// 创建根实例
var app = new Vue({
    el: '#app',
    components: {
        'my-component': child
    }
})
```

> 提示：局部组建只能在当前 vue 实例中使用。

# # Prop

prop 是父组件用来传递数据的一个自定义属性。

父组件的数据需要通过 props 把数据传给子组件，子组件需要显式地用 props 选项声明 "prop"：

## 1、使用 Prop 传递数据

```html
<div id="app">
    <my-component message="Hello"></my-component>
</div>
```

```javascript
// 注册组件
Vue.component('my-component', {
    // 声明 props
    props: ['message'],
    // 同样也可以在 vm 实例中像 "this.message" 这样使用
    template: '<p>{{ message  }}</p>'
})
// 创建根实例
var app = new Vue({
    el: '#app'
})
```

## 2、动态 Prop

类似于用 v-bind 绑定 HTML 特性到一个表达式，也可以用 v-bind 动态绑定 props 的值到父组件的数据中。每当父组件的数据变化时，该变化也会传导给子组件：

```html
<div id="app">
    <form action="" name="myForm">
        <input type="text" v-model="parentMsg">
    </form>
    <my-component v-bind:message="parentMsg"></my-component>
</div>
```

```javascript
// 注册组件
Vue.component('my-component', {
    // 声明 props
    props: ['message'],
    // 同样也可以在 vm 实例中像 "this.message" 这样使用
    template: '<p>{{ message  }}</p>'
})
// 创建根实例
var app = new Vue({
    el: '#app',
    data: {
        parentMsg: '父组件内容...'
    }
})
```

![](IMGS/v-model-dynamic-prop.gif)

## 3、Prop 验证

我们可以为组件的 prop 指定验证规则。如果传入的数据不符合要求，Vue 会发出警告。这对于开发给他人使用的组件非常有用。

要指定验证规则，需要用对象的形式来定义 prop，而不能用字符串数组：

```javascript
Vue.component('example', {
    props: {
        // 基础类型检测 (`null` 指允许任何类型)
        propA: Number,
        // 可能是多种类型
        propB: [String, Number],
        // 必传且是字符串
        propC: {
            type: String,
            required: true
        },
        // 数值且有默认值
        propD: {
            type: Number,
            default: 100
        },
        // 数组/对象的默认值应当由一个工厂函数返回
        propE: {
            type: Object,
            default: function () {
                return { message: 'hello' }
            }
        },
        // 自定义验证函数
        propF: {
            validator: function (value) {
                return value > 10
            }
        }
    }
})
```

`type` 可以是下面原生构造器：

- String
- Number
- Boolean
- Function
- Object
- Array
- Symbol

`type` 也可以是一个自定义构造器函数，使用 `instanceof` 检测。

当 prop 验证失败，Vue 会抛出警告 (如果使用的是开发版本)。注意 prop 会在组件实例创建**之前**进行校验，所以在 `default` 或 `validator` 函数里，诸如 `data`、`computed` 或 `methods` 等实例属性还无法使用。

# # 自定义事件

父组件是使用 props 传递数据给子组件，但如果子组件要把数据传递回去，就需要使用自定义事件！

我们可以使用 v-on 绑定自定义事件, 每个 Vue 实例都实现了事件接口(Events interface)，即：

- 使用 `$on(eventName)` 监听事件
- 使用 `$emit(eventName)` 触发事件

另外，父组件可以在使用子组件的地方直接用 v-on 来监听子组件触发的事件。

以下实例中子组件已经和它外部完全解耦了。它所做的只是触发一个父组件关心的内部事件。

















